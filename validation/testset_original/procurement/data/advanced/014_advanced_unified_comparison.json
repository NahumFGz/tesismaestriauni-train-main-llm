[
  {
    "id": "advanced_14",
    "question": "Dame los estadisticos de los montos de los contratos y ordenes de servicio en del proveedor IBM en el a√±o 2021. Solo quiero el tipo de contrato, la cantidad, el monto promedio, la desviacion estandar, el monto minimo, el monto maximo, el percentil 25, la mediana, el percentil 75 y el percentil 95.",
    "query": "SELECT tipo_contrato, COUNT(*) as cantidad, AVG(monto) as monto_promedio, STDDEV(monto) as desviacion_estandar, MIN(monto) as monto_minimo, MAX(monto) as monto_maximo, PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY monto) as percentil_25, PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY monto) as mediana, PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY monto) as percentil_75, PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY monto) as percentil_95 FROM contratos_orden_servicio WHERE EXTRACT(YEAR FROM fecha_inicio) = 2021 AND nombre_proveedor ILIKE '%IBM%' GROUP BY tipo_contrato;",
    "expected": {
      "columns": [
        "tipo_contrato",
        "cantidad",
        "monto_promedio",
        "desviacion_estandar",
        "monto_minimo",
        "monto_maximo",
        "percentil_25",
        "mediana",
        "percentil_75",
        "percentil_95"
      ],
      "rows": [
        [
          "CONTRATO",
          2,
          2610376.975,
          2190797.0567055168,
          1061249.52,
          4159504.43,
          1835813.2475,
          2610376.975,
          3384940.7025,
          4004591.6845
        ],
        [
          "ORDEN SERVICIO",
          1,
          10500.0,
          null,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0
        ]
      ],
      "row_count": 2,
      "column_count": 10
    },
    "baseline_template": {
      "sql_query": "SELECT tipo_contrato, COUNT(*) as cantidad, AVG(monto) as monto_promedio, STDDEV(monto) as desviacion_estandar, MIN(monto) as monto_minimo, MAX(monto) as monto_maximo, PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY monto) as percentil_25, PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY monto) as mediana, PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY monto) as percentil_75, PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY monto) as percentil_95 FROM contratos_orden_servicio WHERE EXTRACT(YEAR FROM fecha_inicio) = 2021 AND nombre_proveedor ILIKE '%IBM%' GROUP BY tipo_contrato LIMIT 100;",
      "columns": [
        "tipo_contrato",
        "cantidad",
        "monto_promedio",
        "desviacion_estandar",
        "monto_minimo",
        "monto_maximo",
        "percentil_25",
        "mediana",
        "percentil_75",
        "percentil_95"
      ],
      "rows": [
        [
          "CONTRATO",
          2,
          2610376.975,
          2190797.0567055168,
          1061249.52,
          4159504.43,
          1835813.2475,
          2610376.975,
          3384940.7025,
          4004591.6845
        ],
        [
          "ORDEN SERVICIO",
          1,
          10500.0,
          null,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0
        ]
      ],
      "row_count": 2,
      "column_count": 10
    },
    "baseline_agent_simple": {
      "sql_query": "SELECT tipo_contrato, COUNT(*) AS cantidad, AVG(monto) AS monto_promedio, STDDEV(monto) AS desviacion_estandar, MIN(monto) AS monto_minimo, MAX(monto) AS monto_maximo, PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY monto) AS percentil_25, PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY monto) AS mediana, PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY monto) AS percentil_75, PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY monto) AS percentil_95 FROM contratos_orden_servicio WHERE EXTRACT(YEAR FROM fecha_inicio) = 2021 AND nombre_proveedor ILIKE '%IBM%' GROUP BY tipo_contrato;",
      "columns": [
        "tipo_contrato",
        "cantidad",
        "monto_promedio",
        "desviacion_estandar",
        "monto_minimo",
        "monto_maximo",
        "percentil_25",
        "mediana",
        "percentil_75",
        "percentil_95"
      ],
      "rows": [
        [
          "CONTRATO",
          2,
          2610376.975,
          2190797.0567055168,
          1061249.52,
          4159504.43,
          1835813.2475,
          2610376.975,
          3384940.7025,
          4004591.6845
        ],
        [
          "ORDEN SERVICIO",
          1,
          10500.0,
          null,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0
        ]
      ],
      "row_count": 2,
      "column_count": 10
    },
    "our_agent": {
      "sql_query": "SELECT tipo_contrato, COUNT(*) as cantidad, CAST(AVG(monto) AS DECIMAL(15,2)) as monto_promedio, CAST(STDDEV(monto) AS DECIMAL(15,2)) as desviacion_estandar, CAST(MIN(monto) AS DECIMAL(15,2)) as monto_minimo, CAST(MAX(monto) AS DECIMAL(15,2)) as monto_maximo, CAST(PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY monto) AS DECIMAL(15,2)) as percentil_25, CAST(PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY monto) AS DECIMAL(15,2)) as mediana, CAST(PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY monto) AS DECIMAL(15,2)) as percentil_75, CAST(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY monto) AS DECIMAL(15,2)) as percentil_95 FROM contratos_orden_servicio WHERE UPPER(nombre_proveedor) LIKE '%IBM%' AND EXTRACT(YEAR FROM fecha_inicio) = 2021 GROUP BY tipo_contrato ORDER BY tipo_contrato;",
      "columns": [
        "tipo_contrato",
        "cantidad",
        "monto_promedio",
        "desviacion_estandar",
        "monto_minimo",
        "monto_maximo",
        "percentil_25",
        "mediana",
        "percentil_75",
        "percentil_95"
      ],
      "rows": [
        [
          "CONTRATO",
          2,
          2610376.975,
          2190797.0567055168,
          1061249.52,
          4159504.43,
          1835813.2475,
          2610376.975,
          3384940.7025,
          4004591.6845
        ],
        [
          "ORDEN SERVICIO",
          1,
          10500.0,
          null,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0,
          10500.0
        ]
      ],
      "row_count": 2,
      "column_count": 10
    },
    "complexity_level": "advanced",
    "question_type": "advanced",
    "generated_at": "2025-09-18T09:03:29.816926",
    "execution_id": 14
  }
]