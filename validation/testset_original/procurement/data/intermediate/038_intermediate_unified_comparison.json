[
  {
    "id": "intermediate_38",
    "question": "Que proveedores que inicaron sus actividades en febrero del 2020 han formado mas ordenes de servicio, quiero el top 3 ordenados por la cantidad de ordenes de servicio y el monto total ordenes de servicio.",
    "query": "SELECT t.ruc_proveedor, t.nombre_proveedor, t.fecha_de_inicio_de_actividades, COUNT(c.ruc_proveedor) as cantidad_ordenes_servicio, SUM(c.monto) as monto_total_ordenes_servicio FROM transparencia_sunat t INNER JOIN contratos_orden_servicio c ON t.ruc_proveedor = c.ruc_proveedor WHERE DATE_TRUNC('month', t.fecha_de_inicio_de_actividades) = '2020-02-01'::date AND c.tipo_contrato = 'ORDEN SERVICIO' GROUP BY t.ruc_proveedor, t.nombre_proveedor, t.fecha_de_inicio_de_actividades ORDER BY cantidad_ordenes_servicio DESC, monto_total_ordenes_servicio DESC LIMIT 3;",
    "expected": {
      "columns": [
        "ruc_proveedor",
        "nombre_proveedor",
        "fecha_de_inicio_de_actividades",
        "cantidad_ordenes_servicio",
        "monto_total_ordenes_servicio"
      ],
      "rows": [
        [
          "20605925520",
          "W & M SIRYCATA S.A.C.",
          "2020-02-18",
          500,
          2577520.2800000003
        ],
        [
          "20605953884",
          "DISTRIBUIDOR KAERDAJ EMPRESA INDIVIDUAL DE RESPONSABILIDAD LIMITADA",
          "2020-02-24",
          500,
          1019607.3500000008
        ],
        [
          "20605716998",
          "CHRISDALIZ EMPRESA INDIVIDUAL DE RESPONSABILIDAD LIMITADA",
          "2020-02-01",
          500,
          989683.1500000003
        ]
      ],
      "row_count": 5,
      "column_count": 3
    },
    "baseline_template": {
      "sql_query": "SELECT nombre_proveedor, COUNT(*) as num_contratos, SUM(monto) as monto_total FROM contratos_orden_servicio WHERE EXTRACT(YEAR FROM fecha_inicio) = CAST('2020' AS INTEGER) GROUP BY nombre_proveedor ORDER BY monto_total DESC LIMIT 10;",
      "columns": [
        "nombre_proveedor",
        "num_contratos",
        "monto_total"
      ],
      "rows": [
        [
          "QUISPE SULCA JULIA",
          13,
          150910802513592.2
        ],
        [
          "REPUESTOS Y LUBRICANTES LA FLORIDA EIRL",
          20,
          206023352742.0
        ],
        [
          "WONG LOGISTIC S.A.C.",
          49,
          20606636800.040005
        ],
        [
          "GRUPO SURCONET S.A.C.",
          11,
          20606019000.559994
        ],
        [
          "TIZIANNI LOGISTICS SOCIEDAD ANONIMA - TIZIANNI LOGISTICS S.A.",
          103,
          20603509922.95001
        ],
        [
          "R & T QUINTANAS E.I.R.L.",
          4,
          20603275057.0
        ],
        [
          "GRUPO SOLMIT EMPRESA INDIVIDUAL DE RESPONSABILIDAD LIMITADA - GRUPO SOLMIT E.I.R.L.",
          111,
          20602695164.07
        ],
        [
          "GRUPO VITESSE INGENIEROS & ABOGADOS S.A.C.",
          33,
          20563309598.52
        ],
        [
          "RAMIREZ MEZA RAUL",
          9,
          10756993421.0
        ],
        [
          "MONJE JARA RENZO D'ANGELO",
          33,
          10483093582.75
        ]
      ],
      "row_count": 10,
      "column_count": 3
    },
    "baseline_agent_simple": {
      "sql_query": "SELECT ts.ruc_proveedor, ts.nombre_proveedor, COUNT(co.ruc_proveedor) AS cantidad_ordenes_servicio, SUM(co.monto) AS monto_total FROM transparencia_sunat ts JOIN contratos_orden_servicio co ON co.ruc_proveedor = ts.ruc_proveedor WHERE EXTRACT(YEAR FROM ts.fecha_de_inicio_de_actividades) = 2020 AND EXTRACT(MONTH FROM ts.fecha_de_inicio_de_actividades) = 2 AND co.tipo_contrato = 'ORDEN SERVICIO' GROUP BY ts.ruc_proveedor, ts.nombre_proveedor ORDER BY cantidad_ordenes_servicio DESC LIMIT 3;",
      "columns": [
        "ruc_proveedor",
        "nombre_proveedor",
        "cantidad_ordenes_servicio",
        "monto_total"
      ],
      "rows": [
        [
          "20605716998",
          "CHRISDALIZ EMPRESA INDIVIDUAL DE RESPONSABILIDAD LIMITADA",
          500,
          989683.1499999999
        ],
        [
          "20605874968",
          "MIRANDA TRAVEL TOURS S.A.C.",
          500,
          507244.0799999997
        ],
        [
          "20605925520",
          "W & M SIRYCATA S.A.C.",
          500,
          2577520.279999998
        ]
      ],
      "row_count": 3,
      "column_count": 4
    },
    "our_agent": {
      "sql_query": "SELECT t.ruc_proveedor, t.nombre_proveedor, t.fecha_de_inicio_de_actividades, COUNT(c.ruc_proveedor) as cantidad_ordenes_servicio, SUM(c.monto) as monto_total_ordenes_servicio FROM transparencia_sunat t INNER JOIN contratos_orden_servicio c ON t.ruc_proveedor = c.ruc_proveedor WHERE DATE_TRUNC('month', t.fecha_de_inicio_de_actividades) = '2020-02-01'::date AND c.tipo_contrato = 'ORDEN SERVICIO' GROUP BY t.ruc_proveedor, t.nombre_proveedor, t.fecha_de_inicio_de_actividades ORDER BY cantidad_ordenes_servicio DESC, monto_total_ordenes_servicio DESC LIMIT 3;",
      "columns": [
        "ruc_proveedor",
        "nombre_proveedor",
        "fecha_de_inicio_de_actividades",
        "cantidad_ordenes_servicio",
        "monto_total_ordenes_servicio"
      ],
      "rows": [
        [
          "20605925520",
          "W & M SIRYCATA S.A.C.",
          "2020-02-18",
          500,
          2577520.2800000003
        ],
        [
          "20605953884",
          "DISTRIBUIDOR KAERDAJ EMPRESA INDIVIDUAL DE RESPONSABILIDAD LIMITADA",
          "2020-02-24",
          500,
          1019607.3500000008
        ],
        [
          "20605716998",
          "CHRISDALIZ EMPRESA INDIVIDUAL DE RESPONSABILIDAD LIMITADA",
          "2020-02-01",
          500,
          989683.1500000003
        ]
      ],
      "row_count": 3,
      "column_count": 5
    },
    "complexity_level": "intermediate",
    "question_type": "intermediate",
    "generated_at": "2025-09-16T11:02:28.273916",
    "execution_id": 38
  }
]