[
  {
    "id": "intermediate_27",
    "question": "Dame el perfil completo del proveedor de ruc 10295936318, quiero el perfil completo de sus datos y contratos, dame el nombre del proveedor, el monto girado, el tipo de empresa, el tipo de contribuyente, la fecha de inicio de actividades, el total de contratos y el total de ordenes de servicio",
    "query": "SELECT ts.nombre_proveedor, ts.monto_girado, ts.tipo_empresa_persona_juridica_natural, ts.tipo_contribuyente, ts.fecha_de_inicio_de_actividades, COUNT(CASE WHEN co.tipo_contrato = 'CONTRATO' THEN 1 END) AS total_contratos, COUNT(CASE WHEN co.tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) AS total_ordenes_servicio FROM transparencia_sunat ts LEFT JOIN contratos_orden_servicio co ON co.ruc_proveedor = ts.ruc_proveedor WHERE ts.ruc_proveedor = '10295936318' GROUP BY ts.nombre_proveedor, ts.monto_girado, ts.tipo_empresa_persona_juridica_natural, ts.tipo_contribuyente, ts.fecha_de_inicio_de_actividades;",
    "expected": {
      "columns": [
        "nombre_proveedor",
        "monto_girado",
        "tipo_empresa_persona_juridica_natural",
        "tipo_contribuyente",
        "fecha_de_inicio_de_actividades",
        "total_contratos",
        "total_ordenes_servicio"
      ],
      "rows": [
        [
          "HERRERA ORE PALERMO",
          25863604.43,
          "PERSONA NATURAL",
          "PERSONA NATURAL CON NEGOCIO",
          "2006-08-07",
          57,
          2
        ]
      ],
      "row_count": 1,
      "column_count": 7
    },
    "baseline_template": {
      "sql_query": "SELECT nombre_proveedor FROM transparencia_sunat WHERE ruc_proveedor = '10295936318' LIMIT 1;",
      "columns": [
        "nombre_proveedor"
      ],
      "rows": [
        [
          "HERRERA ORE PALERMO"
        ]
      ],
      "row_count": 1,
      "column_count": 1
    },
    "baseline_agent_simple": {
      "sql_query": "SELECT ts.nombre_proveedor, ts.monto_girado, ts.tipo_empresa_persona_juridica_natural, ts.tipo_contribuyente, ts.fecha_de_inicio_de_actividades, COUNT(co.tipo_contrato) AS total_contratos, COUNT(CASE WHEN co.tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) AS total_ordenes_servicio FROM transparencia_sunat ts LEFT JOIN contratos_orden_servicio co ON co.ruc_proveedor = ts.ruc_proveedor WHERE ts.ruc_proveedor = '10295936318' GROUP BY ts.nombre_proveedor, ts.monto_girado, ts.tipo_empresa_persona_juridica_natural, ts.tipo_contribuyente, ts.fecha_de_inicio_de_actividades;",
      "columns": [
        "nombre_proveedor",
        "monto_girado",
        "tipo_empresa_persona_juridica_natural",
        "tipo_contribuyente",
        "fecha_de_inicio_de_actividades",
        "total_contratos",
        "total_ordenes_servicio"
      ],
      "rows": [
        [
          "HERRERA ORE PALERMO",
          25863604.43,
          "PERSONA NATURAL",
          "PERSONA NATURAL CON NEGOCIO",
          "2006-08-07",
          59,
          2
        ]
      ],
      "row_count": 1,
      "column_count": 7
    },
    "our_agent": {
      "sql_query": "SELECT t.nombre_proveedor, t.monto_girado, t.tipo_empresa_persona_juridica_natural, t.tipo_contribuyente, t.fecha_de_inicio_de_actividades, COUNT(CASE WHEN c.tipo_contrato = 'CONTRATO' THEN 1 END) as total_contratos, COUNT(CASE WHEN c.tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) as total_ordenes_servicio FROM transparencia_sunat t LEFT JOIN contratos_orden_servicio c ON t.ruc_proveedor = c.ruc_proveedor WHERE t.ruc_proveedor = '10295936318' GROUP BY t.ruc_proveedor, t.nombre_proveedor, t.monto_girado, t.tipo_empresa_persona_juridica_natural, t.tipo_contribuyente, t.fecha_de_inicio_de_actividades;",
      "columns": [
        "nombre_proveedor",
        "monto_girado",
        "tipo_empresa_persona_juridica_natural",
        "tipo_contribuyente",
        "fecha_de_inicio_de_actividades",
        "total_contratos",
        "total_ordenes_servicio"
      ],
      "rows": [
        [
          "HERRERA ORE PALERMO",
          25863604.43,
          "PERSONA NATURAL",
          "PERSONA NATURAL CON NEGOCIO",
          "2006-08-07",
          57,
          2
        ]
      ],
      "row_count": 1,
      "column_count": 7
    },
    "complexity_level": "intermediate",
    "question_type": "intermediate",
    "generated_at": "2025-09-16T04:35:28.611197",
    "execution_id": 27
  }
]