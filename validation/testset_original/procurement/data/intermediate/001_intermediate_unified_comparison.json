[
  {
    "id": "intermediate_1",
    "question": "Â¿Cuantos contratos y ordenes de servicio tiene la entidad contratante MUNICIPALIDAD DISTRITAL DE PARACAS?, quiero las columnas cantidad_contratos_ordenes, monto_total, cantidad_contratos y cantidad_ordenes_servicio",
    "query": "SELECT COUNT(*) as cantidad_contratos_ordenes, SUM(monto) as monto_total, COUNT(CASE WHEN tipo_contrato = 'CONTRATO' THEN 1 END) as cantidad_contratos, COUNT(CASE WHEN tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) as cantidad_ordenes_servicio FROM contratos_orden_servicio WHERE entidad_contratante = 'MUNICIPALIDAD DISTRITAL DE PARACAS'",
    "expected": {
      "columns": [
        "cantidad_contratos_ordenes",
        "monto_total",
        "cantidad_contratos",
        "cantidad_ordenes_servicio"
      ],
      "rows": [
        [
          11348.0,
          248671780.53999996,
          328.0,
          11020.0
        ]
      ],
      "row_count": 1,
      "column_count": 4
    },
    "baseline_template": {
      "sql_query": "SELECT COUNT(*) as cantidad_contratos_ordenes, SUM(monto) as monto_total, COUNT(CASE WHEN tipo_contrato = 'CONTRATO' THEN 1 END) as cantidad_contratos, COUNT(CASE WHEN tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) as cantidad_ordenes_servicio FROM contratos_orden_servicio WHERE entidad_contratante = 'MUNICIPALIDAD DISTRITAL DE PARACAS' LIMIT 1;",
      "columns": [
        "cantidad_contratos_ordenes",
        "monto_total",
        "cantidad_contratos",
        "cantidad_ordenes_servicio"
      ],
      "rows": [
        [
          11348.0,
          248671780.53999996,
          328.0,
          11020.0
        ]
      ],
      "row_count": 1,
      "column_count": 4
    },
    "baseline_agent_simple": {
      "sql_query": "SELECT COUNT(*) AS cantidad_contratos_ordenes, SUM(monto) AS monto_total, COUNT(CASE WHEN tipo_contrato = 'CONTRATO' THEN 1 END) AS cantidad_contratos, COUNT(CASE WHEN tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) AS cantidad_ordenes_servicio FROM contratos_orden_servicio co WHERE co.entidad_contratante ILIKE '%MUNICIPALIDAD DISTRITAL DE PARACAS%';",
      "columns": [
        "cantidad_contratos_ordenes",
        "monto_total",
        "cantidad_contratos",
        "cantidad_ordenes_servicio"
      ],
      "rows": [
        [
          11348.0,
          248671780.53999996,
          328.0,
          11020.0
        ]
      ],
      "row_count": 1,
      "column_count": 4
    },
    "our_agent": {
      "sql_query": "SELECT COUNT(*) as cantidad_contratos_ordenes, SUM(monto) as monto_total, COUNT(CASE WHEN tipo_contrato = 'CONTRATO' THEN 1 END) as cantidad_contratos, COUNT(CASE WHEN tipo_contrato = 'ORDEN SERVICIO' THEN 1 END) as cantidad_ordenes_servicio FROM contratos_orden_servicio WHERE entidad_contratante = 'MUNICIPALIDAD DISTRITAL DE PARACAS'",
      "columns": [
        "cantidad_contratos_ordenes",
        "monto_total",
        "cantidad_contratos",
        "cantidad_ordenes_servicio"
      ],
      "rows": [
        [
          11348.0,
          248671780.53999996,
          328.0,
          11020.0
        ]
      ],
      "row_count": 1,
      "column_count": 4
    },
    "complexity_level": "intermediate",
    "question_type": "intermediate",
    "generated_at": "2025-09-12T10:20:31.300257",
    "execution_id": 1
  }
]